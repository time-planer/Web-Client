function View(comp){this.comp=comp,null!=this.comp&&(this.element=comp.base.clone().show())}function Component(name){null!=name&&(this.name=name,this.load())}View.prototype.get=function(){return null==this.element&&init(),this.element},View.prototype.element=null,View.prototype.refresh=function(){this.element.html(this.comp.base.clone().html()),this.comp.init(this.get())},View.prototype.get=function(){return this.element},View.prototype.$=View.prototype.get,View.prototype.init=function(){this.comp.init(this)},Component.prototype.base=null,Component.prototype.load=function(){this.base=$($.ajax({type:"GET",url:"components/"+this.name+".html",async:!1}).responseText)},Component.prototype.create=function(){return new View(this)},Component.prototype.init=function(v){};var components=[],views=[],defInit=function(view){view.get().find("[subst]").each(function(){var val=$(this).attr("subst");$(this).text(view[val])})};$(document).ready(function(){$(".component").hide().each(function(){var elem=$(this),comp=new Component;comp.name=elem.attr("name"),comp.base=elem,comp.init=defInit,components.push(comp)}),$(".view").show().each(function(){for(var elem=$(this),i=0;i<components.length;i++){if((c=components[i]).name===elem.attr("name")){var v=c.create();return views.push(v),$(elem[0].attributes).each(function(){v[this.name]=this.value}),v.init(),void elem.html(v.get())}}var c;(c=new Component(elem.attr("name"))).load();v=c.create();views.push(v),$(elem[0].attributes).each(function(){v[this.name]=this.value}),v.init(),elem.html(v.get())})});